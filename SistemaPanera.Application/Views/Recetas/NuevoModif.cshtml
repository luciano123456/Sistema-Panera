@{
    ViewBag.Title = "Nueva Receta";
}

<title>@ViewBag.Title</title>

@section Estilos {


    <link href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" rel="stylesheet" />

    @*ESTILOS DE BOTONES*@
    <link href="https://cdn.datatables.net/buttons/2.2.2/css/buttons.dataTables.min.css" rel="stylesheet" />

    @*filter columns*@
    <link href="https://cdn.datatables.net/fixedheader/3.2.2/css/fixedHeader.dataTables.min.css" rel="stylesheet" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link href="~/css/Recetas.css" rel="stylesheet" />
    <link href="~/css/RecetasNuevoModif.css" rel="stylesheet" />
}

<div class="tituloRecetaclass mt-5">
    <h2 class="tituloReceta">Nueva Receta</h2>
</div>




<partial name="~/Views/Utils/Modals.cshtml" />


<div class="container-fluid mt-5">



    <!-- Pestañas -->
    <ul class="nav nav-tabs pestaniasDatos" id="myTab" role="tablist">


        <li class="nav-item lg-12" role="presentation">
            <a class="nav-link active" id="Receta-tab" data-bs-toggle="tab" href="#Receta" role="tab" aria-controls="Receta" aria-selected="false">Datos de la Receta</a>
        </li>
    </ul>

    <!-- Contenido de las pestañas -->
    <div class="tab-content mt-4" id="myTabContent">
        <div class="tab-pane fade show active" id="Receta" role="tabpanel" aria-labelledby="Receta-tab">
            <div class="card mb-4">
                <div class="card-body">
                    <h3 class="card-title">Datos de la Receta</h3>
                    <input type="text" class="input-nuevo" id="idReceta" name="idReceta" hidden>
                    <div class="form-container">
                        <div class="form-group">
                            <label for="txtUnidadNegocio">Unidad de Negocio</label>
                            <select id="UnidadesNegocio" name="select" class="input-nuevo-select select-modal-personalizado mt-2">
                                <option value="" selected>Unidad de Negocio</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="dniCliente">Sku</label>
                            <input type="text" class="input-nuevo" id="sku" name="sku">
                        </div>
                        <div class="form-group">
                            <label for="descripcion">Descripcion</label>
                            <input type="text" class="input-nuevo" id="descripcion" name="descripcion">
                        </div>
                        <div class="form-group">
                            <label for="txtUnidadNegocio">Categoria</label>
                            <select id="Categorias" name="select" class="input-nuevo-select select-modal-personalizado mt-2">
                                <option value="" selected>Categoria</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="txtUnidadNegocio">Unidad de Medida</label>
                            <select id="UnidadMedidas" name="select" class="input-nuevo-select select-modal-personalizado mt-2">
                                <option value="" selected>Unidad de Medida</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="costoUnitario">Costo Subrecetas</label>
                            <input type="text" class="input-nuevo" id="costoSubrecetas" name="costoSubrecetas">
                        </div>
                        <div class="form-group">
                            <label for="costoInsumos">Costo Insumos</label>
                            <input type="text" class="input-nuevo" id="costoInsumos" name="costoInsumos">
                        </div>
                        <div class="form-group">
                            <label for="costoTotal">Costo Total</label>
                            <input type="text" class="input-nuevo" id="costoTotal" name="costoTotal">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pestañas -->
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <a class="nav-link active" id="Subrecetas-tab" data-bs-toggle="tab" href="#Subrecetas" role="tab" aria-controls="Subrecetas" aria-selected="true">Subrecetas</a>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" id="insumos-tab" data-bs-toggle="tab" href="#insumos" role="tab" aria-controls="insumos" aria-selected="false">Insumos</a>
            </li>
        </ul>

        <!-- Contenido de las pestañas -->
        <div class="tab-content mt-4" id="myTabContent">
            <!-- Subrecetas -->
            <div class="tab-pane fade show active" id="Subrecetas" role="tabpanel" aria-labelledby="Subrecetas-tab">
                <div class="card mb-12">
                    <div class="card-body">
                        <h3 class="card-title">Subrecetas</h3>
                        <table class="display nowrap" id="grd_Subrecetas" style="width:100%">
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Costo Unitario</th>
                                    <th>Cantidad</th>
                                    <th>SubTotal</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Aquí va el contenido de tu DataTable de Subrecetas -->
                            </tbody>
                        </table>
                        <div class="d-flex justify-content-end mt-3">
                            <div class="btn-group" role="group">
                                <button type="button" class="btn btn-success" onclick="anadirSubreceta()">
                                    <i class="fa fa-plus"></i> Añadir
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Insumos -->
            <div class="tab-pane fade" id="insumos" role="tabpanel" aria-labelledby="insumos-tab">
                <div class="card mb-12">
                    <div class="card-body">
                        <h3 class="card-title">Insumos</h3>
                        <table class="display nowrap" id="grd_Insumos" style="width:100%">
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Costo Unitario</th>
                                    <th>Cantidad</th>
                                    <th>SubTotal</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Aquí va el contenido de tu DataTable de Insumos -->
                            </tbody>
                        </table>
                        <div class="d-flex justify-content-end mt-3">
                            <div class="btn-group" role="group">
                                <button type="button" class="btn btn-success" onclick="anadirInsumo()">
                                    <i class="fa fa-plus"></i> Añadir
                                </button>
                            </div>
                        </div>

                    </div>

                </div>

            </div>




        </div>





        <button type="submit" id="btnNuevoModificar" class="btn btn-primary mt-3" onclick="guardarCambios()">Registrar</button>


        <div class="modal fade" id="insumosModal" tabindex="-1" role="dialog" aria-labelledby="insumosModalLabel" aria-hidden="true" data-editing="false">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="insumosModalLabel">Seleccionar Insumo</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="insumoSelect" class="text-black">Insumo</label>
                            <select id="insumoSelect" class="form-control"></select>
                        </div>
                        <div class="form-group">
                            <label for="precioInput" class="text-black">Precio</label>
                            <input type="text" id="precioInput" class="form-control" placeholder="Ingrese precio manual" step="0.01">
                        </div>
                        <div class="form-group">
                            <label for="cantidadInput" class="text-black">Cantidad</label>
                            <input type="number" id="cantidadInput" class="form-control" placeholder="Ingrese cantidad">
                        </div>
                        <div class="form-group">
                            <label for="totalInput" class="text-black">Total</label>
                            <input type="text" id="totalInput" class="form-control" disabled>
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                        <button type="button" id="btnGuardarInsumo" class="btn btn-primary" onclick="guardarInsumo()">Añadir</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="SubrecetasModal" tabindex="-1" role="dialog" aria-labelledby="SubrecetasModalLabel" aria-hidden="true" data-editing="false">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="SubrecetasModalLabel">Seleccionar Subreceta</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="SubrecetaSelect" class="text-black">Subreceta</label>
                            <select id="SubrecetaSelect" class="form-control"></select>
                        </div>
                        <div class="form-group">
                            <label for="precioSubrecetaInput" class="text-black">Precio</label>
                            <input type="text" id="precioSubrecetaInput" class="form-control" placeholder="Ingrese precio manual" step="0.01">
                        </div>
                        <div class="form-group">
                            <label for="cantidadSubrecetaInput" class="text-black">Cantidad</label>
                            <input type="number" id="cantidadSubrecetaInput" class="form-control" placeholder="Ingrese cantidad">
                        </div>
                        <div class="form-group">
                            <label for="totalSubrecetaInput" class="text-black">Total</label>
                            <input type="text" id="totalSubrecetaInput" class="form-control" disabled>
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                        <button type="button" id="btnGuardarSubreceta" class="btn btn-primary" onclick="guardarSubreceta()">Añadir</button>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <partial name="~/Views/Utils/Modals.cshtml" />

        @section Scripts {

        <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>

            @*SCRIPTS DE BOTONES*@
        <script src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js">


        <script src="~/js/utils/moment.js"></script>
        <script src="~/js/RecetasNuevoModif.js">

            <script src="~/js/site.js"></script>

        <script>
            var recetaData = @Html.Raw(Json.Serialize(ViewBag.Data ?? new { }));
        </script>

        }
